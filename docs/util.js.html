<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>util.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/Mirasaki/discord.js-bot-template" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><h3>Modules</h3><ul><li><a href="module-Client.html">Client</a></li><li><a href="module-Handler_Commands.html">Handler/Commands</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~checkCommandCanExecute">checkCommandCanExecute</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~clearApplicationCommandData">clearApplicationCommandData</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~generateCommandInfoEmbed">generateCommandInfoEmbed</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~generateCommandOverviewEmbed">generateCommandOverviewEmbed</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~getCommandMap">getCommandMap</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~getCommandSelectMenu">getCommandSelectMenu</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~getThrottleId">getThrottleId</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~hasAccessToComponentCommand">hasAccessToComponentCommand</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~isAppropriateCommandFilter">isAppropriateCommandFilter</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~logCommandApiData">logCommandApiData</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~refreshSlashCommandData">refreshSlashCommandData</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~registerGlobalCommands">registerGlobalCommands</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~registerTestServerCommands">registerTestServerCommands</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~sortCommandsByCategory">sortCommandsByCategory</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Commands.html#~throttleCommand">throttleCommand</a></li></ul></li><li><a href="module-Handler_Permissions.html">Handler/Permissions</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Handler_Permissions.html#~getInvalidPerms">getInvalidPerms</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Permissions.html#~getPermissionLevel">getPermissionLevel</a></li><li data-type='method' style='display: none;'><a href="module-Handler_Permissions.html#~hasChannelPerms">hasChannelPerms</a></li></ul></li><li><a href="module-Utils.html">Utils</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module-Utils.html#~capitalizeString">capitalizeString</a></li><li data-type='method' style='display: none;'><a href="module-Utils.html#~colorResolver">colorResolver</a></li><li data-type='method' style='display: none;'><a href="module-Utils.html#~getBotInviteLink">getBotInviteLink</a></li><li data-type='method' style='display: none;'><a href="module-Utils.html#~getFiles">getFiles</a></li><li data-type='method' style='display: none;'><a href="module-Utils.html#~getRelativeTime">getRelativeTime</a></li><li data-type='method' style='display: none;'><a href="module-Utils.html#~getRuntime">getRuntime</a></li><li data-type='method' style='display: none;'><a href="module-Utils.html#~parseSnakeCaseArray">parseSnakeCaseArray</a></li><li data-type='method' style='display: none;'><a href="module-Utils.html#~sleep">sleep</a></li><li data-type='method' style='display: none;'><a href="module-Utils.html#~splitCamelCaseStr">splitCamelCaseStr</a></li><li data-type='method' style='display: none;'><a href="module-Utils.html#~titleCase">titleCase</a></li></ul></li></ul><h3>Classes</h3><ul><li><a href="APICommand.html">APICommand</a><ul class='methods'><li data-type='method' style='display: none;'><a href="APICommand.html#load">load</a></li><li data-type='method' style='display: none;'><a href="APICommand.html#reload">reload</a></li><li data-type='method' style='display: none;'><a href="APICommand.html#setFilePathDetails">setFilePathDetails</a></li><li data-type='method' style='display: none;'><a href="APICommand.html#setPermLevel">setPermLevel</a></li><li data-type='method' style='display: none;'><a href="APICommand.html#unload">unload</a></li><li data-type='method' style='display: none;'><a href="APICommand.html#validateConfig">validateConfig</a></li></ul></li><li><a href="ChatInputCommand.html">ChatInputCommand</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ChatInputCommand.html#load">load</a></li><li data-type='method' style='display: none;'><a href="ChatInputCommand.html#reload">reload</a></li><li data-type='method' style='display: none;'><a href="ChatInputCommand.html#setFilePathDetails">setFilePathDetails</a></li><li data-type='method' style='display: none;'><a href="ChatInputCommand.html#setPermLevel">setPermLevel</a></li><li data-type='method' style='display: none;'><a href="ChatInputCommand.html#unload">unload</a></li><li data-type='method' style='display: none;'><a href="ChatInputCommand.html#validateConfig">validateConfig</a></li></ul></li><li><a href="CommandBase.html">CommandBase</a><ul class='methods'><li data-type='method' style='display: none;'><a href="CommandBase.html#load">load</a></li><li data-type='method' style='display: none;'><a href="CommandBase.html#reload">reload</a></li><li data-type='method' style='display: none;'><a href="CommandBase.html#setFilePathDetails">setFilePathDetails</a></li><li data-type='method' style='display: none;'><a href="CommandBase.html#setPermLevel">setPermLevel</a></li><li data-type='method' style='display: none;'><a href="CommandBase.html#unload">unload</a></li><li data-type='method' style='display: none;'><a href="CommandBase.html#validateConfig">validateConfig</a></li></ul></li><li><a href="ComponentCommand.html">ComponentCommand</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ComponentCommand.html#load">load</a></li><li data-type='method' style='display: none;'><a href="ComponentCommand.html#reload">reload</a></li><li data-type='method' style='display: none;'><a href="ComponentCommand.html#setFilePathDetails">setFilePathDetails</a></li><li data-type='method' style='display: none;'><a href="ComponentCommand.html#setPermLevel">setPermLevel</a></li><li data-type='method' style='display: none;'><a href="ComponentCommand.html#unload">unload</a></li><li data-type='method' style='display: none;'><a href="ComponentCommand.html#validateConfig">validateConfig</a></li></ul></li><li><a href="MessageContextCommand.html">MessageContextCommand</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MessageContextCommand.html#load">load</a></li><li data-type='method' style='display: none;'><a href="MessageContextCommand.html#reload">reload</a></li><li data-type='method' style='display: none;'><a href="MessageContextCommand.html#setFilePathDetails">setFilePathDetails</a></li><li data-type='method' style='display: none;'><a href="MessageContextCommand.html#setPermLevel">setPermLevel</a></li><li data-type='method' style='display: none;'><a href="MessageContextCommand.html#unload">unload</a></li><li data-type='method' style='display: none;'><a href="MessageContextCommand.html#validateConfig">validateConfig</a></li></ul></li><li><a href="UserContextCommand.html">UserContextCommand</a><ul class='methods'><li data-type='method' style='display: none;'><a href="UserContextCommand.html#load">load</a></li><li data-type='method' style='display: none;'><a href="UserContextCommand.html#reload">reload</a></li><li data-type='method' style='display: none;'><a href="UserContextCommand.html#setFilePathDetails">setFilePathDetails</a></li><li data-type='method' style='display: none;'><a href="UserContextCommand.html#setPermLevel">setPermLevel</a></li><li data-type='method' style='display: none;'><a href="UserContextCommand.html#unload">unload</a></li><li data-type='method' style='display: none;'><a href="UserContextCommand.html#validateConfig">validateConfig</a></li></ul></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-adding-commands.html">adding-commands</a></li><li><a href="tutorial-permissions.html">permissions</a></li></ul><h3>Externals</h3><ul><li><a href="external-DiscordActionRowBuilder.html">DiscordActionRowBuilder</a></li><li><a href="external-DiscordActivityOptions.html">DiscordActivityOptions</a></li><li><a href="external-DiscordAPIApplicationCommand.html">DiscordAPIApplicationCommand</a></li><li><a href="external-DiscordChatInputInteraction.html">DiscordChatInputInteraction</a></li><li><a href="external-DiscordClient.html">DiscordClient</a></li><li><a href="external-DiscordClientPresenceStatus.html">DiscordClientPresenceStatus</a></li><li><a href="external-DiscordCollection.html">DiscordCollection</a></li><li><a href="external-DiscordCommandInteraction.html">DiscordCommandInteraction</a></li><li><a href="external-DiscordEmbedBuilder.html">DiscordEmbedBuilder</a></li><li><a href="external-DiscordGatewayIntentBits.html">DiscordGatewayIntentBits</a></li><li><a href="external-DiscordGuildChannel.html">DiscordGuildChannel</a></li><li><a href="external-DiscordGuildMember.html">DiscordGuildMember</a></li><li><a href="external-DiscordPermissionResolvable.html">DiscordPermissionResolvable</a></li></ul><h3>Global</h3><ul><li><a href="global.html#APICommandConfig">APICommandConfig</a></li><li><a href="global.html#BaseConfig">BaseConfig</a></li><li><a href="global.html#CommandBaseCooldown">CommandBaseCooldown</a></li><li><a href="global.html#CommandCallback">CommandCallback</a></li><li><a href="global.html#CooldownTypes">CooldownTypes</a></li><li><a href="global.html#PermLevel">PermLevel</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">util.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Our collection of utility functions, exported from the `/src/util.js` file
 * @module Utils
 */

/**
 * The `discord.js` Collection
 * @external DiscordCollection
 * @see {@link https://discord.js.org/#/docs/collection/main/class/Collection}
 */

// Importing from libraries
const { OAuth2Scopes, PermissionFlagsBits } = require('discord.js');
const { readdirSync, statSync } = require('fs');
const moment = require('moment');
const path = require('path');
const colors = require('./config/colors.json');

// Import our constants
const {
  NS_IN_ONE_MS,
  NS_IN_ONE_SECOND,
  DEFAULT_DECIMAL_PRECISION
} = require('./constants');

/**
 * Transforms hex and rgb color input into integer color code
 * @method colorResolver
 * @param {string | Array&lt;number>} [input] Hex color code or RGB array
 * @returns {integer}
 */
const colorResolver = (input) => {
  // Return main bot color if no input is provided
  if (!input) return parseInt(colors.main.slice(1), 16);
  // Hex values
  if (typeof input === 'string') input = parseInt(input.slice(1), 16);
  // RGB values
  else input = (input[0] &lt;&lt; 16) + (input[1] &lt;&lt; 8) + input[2];
  // Returning our result
  return input;
};

/**
 * Get an array of (resolved) absolute file paths in the target directory,
 * Ignores files that start with a "." character
 * @param {string} requestedPath Absolute path to the directory
 * @param {Array&lt;string>} [allowedExtensions=['.js', '.mjs', '.cjs']] Array of file extensions
 * @returns {Array&lt;string>} Array of (resolved) absolute file paths
 */
const getFiles = (requestedPath, allowedExtensions = ['.js', '.mjs', '.cjs']) => {
  if (typeof allowedExtensions === 'string') allowedExtensions = [allowedExtensions];
  requestedPath ??= path.resolve(requestedPath);
  let res = [];
  for (let itemInDir of readdirSync(requestedPath)) {
    itemInDir = path.resolve(requestedPath, itemInDir);
    const stat = statSync(itemInDir);
    if (stat.isDirectory()) res = res.concat(getFiles(itemInDir, allowedExtensions));
    if (
      stat.isFile()
      &amp;&amp; allowedExtensions.find((ext) => itemInDir.endsWith(ext))
      &amp;&amp; !itemInDir.slice(
        itemInDir.lastIndexOf(path.sep) + 1, itemInDir.length
      ).startsWith('.')
    ) res.push(itemInDir);
  }
  return res;
};

/**
 * Utility function for getting the relative time string using moment
 * @param {Date} date The date to get the relative time from
 * @returns {string} Relative time from parameter Date
 */
const getRelativeTime = (date) => moment(date).fromNow();

/**
 * String converter: Mary Had A Little Lamb
 * @param {string} str Any string of characters
 * @returns {string} The string in title-case format
 */
const titleCase = (str) => {
  if (typeof str !== 'string') throw new TypeError('Expected type: String');
  str = str.toLowerCase().split(' ');
  for (let i = 0; i &lt; str.length; i++) str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);
  return str.join(' ');
};

/**
 * String converter: camelCaseString => ['camel', 'Case', 'String']
 * @param {string} str Any camelCase string
 * @param {string | null} joinCharacter If provided, joins the array output back together using the character
 * @returns {Array&lt;string> | string} array of strings if joinCharacter is omitted, string if provided
 */
const splitCamelCaseStr = (str, joinCharacter = ' ') => {
  const arr = str.split(/ |\B(?=[A-Z])/);
  if (typeof joinCharacter === 'string') {
    return arr.join(joinCharacter);
  }
  return arr;
};

/**
 * String converter: Mary had a little lamb
 * @param {*} str The string to capitalize
 * @returns {string} Capitalized string
 */
const capitalizeString = (str) => `${str.charAt(0).toUpperCase()}${str.slice(1)}`;

/**
 * String converter: Parses a SNAKE_CASE_ARRAY to title-cased strings in an array
 * @param {Array&lt;string>} arr Array of strings to convert
 * @returns {Array&lt;string>} Array of title-cases SNAKE_CASE_ARRAY strings
 */
const parseSnakeCaseArray = (arr) => {
  return arr.map((str) => {
    str = str.toLowerCase().split(/[ _]+/);
    for (let i = 0; i &lt; str.length; i++) str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);
    return str.join(' ');
  });
};

/**
 * Get bot invite link, takes required permissions into consideration
 * @param {Client} client Our extended discord.js client
 * @returns {string} The invite link to add the bot to a server
 */
const getBotInviteLink = (client) => {
  const { commands } = client.container;
  const uniqueCombinedPermissions = [ ...new Set([].concat(...commands.map((cmd => cmd.clientPerms)))) ];
  return client.generateInvite({
    scopes: [ OAuth2Scopes.ApplicationsCommands, OAuth2Scopes.Bot ],
    permissions: uniqueCombinedPermissions.map((rawPerm) => PermissionFlagsBits[rawPerm])
  });
};

/**
 * Make the client sleep/wait for a specific amount of time
 * @param {integer} ms The amount of time in milliseconds to wait/sleep
 * @returns {Promise&lt;void>} The promise to await
 */
const sleep = (ms) => new Promise((resolve) => setTimeout(resolve, ms));

/**
 * Get runtime since process.hrtime.bigint() - NOT process.hrtime()
 * @param {bigint} hrtime Timestamp in nanosecond precision
 * @param {number | 2} decimalPrecision Amount of characters to display after decimal point
 * @returns {{ seconds: number, ms: number, ns: bigint }}
 */
const getRuntime = (hrtime, decimalPrecision = DEFAULT_DECIMAL_PRECISION) => {
  // Converting
  const inNS = process.hrtime.bigint() - hrtime;
  const nsNumber = Number(inNS);
  const inMS = (nsNumber / NS_IN_ONE_MS).toFixed(decimalPrecision);
  const InSeconds = (nsNumber / NS_IN_ONE_SECOND).toFixed(decimalPrecision);

  // Return the conversions
  return {
    seconds: InSeconds,
    ms: inMS,
    ns: inNS
  };
};

module.exports = {
  splitCamelCaseStr,
  colorResolver,
  getFiles,
  getRelativeTime,
  titleCase,
  capitalizeString,
  parseSnakeCaseArray,
  getBotInviteLink,
  wait: sleep,
  sleep,
  getRuntime
};
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on Mon Aug 22 2022 21:03:18 GMT+0200 (Central European Summer Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
